syntax = "proto3";
import "CompareAndSwap.proto";

service PaxosAcceptorService {
  rpc Prepare (Request) returns (Reply);
  rpc Accept (Request) returns (Reply);
}
message Request {
	uint32 id = 1;

	message PrepareReq {
		uint32 leaderNumber = 1;
		uint32 paxosInstance = 2;
	}
	message AcceptReq {
		CompareAndSwapRequest value = 1;
		uint32 leaderNumber = 2;
		uint32 paxosInstance = 3;
	}
	optional PrepareReq PrepareRequest = 2;
	optional AcceptReq AcceptRequest = 3;
}

message Reply {
	uint32 id = 1;

	message PromiseResp {
		CompareAndSwapRequest value = 1;
		uint32 writeTimeStamp = 2;
		uint32 paxosInstance = 3;
	}

	message AcceptedResp {
		CompareAndSwapRequest value = 1;
		uint32 leaderNumber = 2;
		uint32 paxosInstance = 3;
	}

	optional PromiseResp PromiseReply = 2;
	optional AcceptedResp AcceptedReply = 3;
}
